# 量子计算(八)——振幅放大

## 一、问题背景

这个算法要解决的问题就是寻找符合要求的解。假设解空间可以被表示为二进制字符串，并且已知某种能够确定解空间中各个解的好坏的标准。

>也就是给出布尔函数$\mathcal{X}$，它将解空间中的解$x$映射到$\{0,1\}$：
>$$\mathcal{X}(x)=\begin{cases}
    0 & ,\quad if\ x\ is\ bad\\
    1 & ,\quad if\ x\ is\ good\\
\end{cases}$$

这个目标基本和$Grover$算法要解决的问题是一致的。事实上，$Grover$算法中的核心算法就是振幅放大，这篇论文就是对$Grover$算法的总结推广，<font color="#dd0000">使得任意无测量量子算法也可以使用(存疑)</font>。

### 1.量子化

显然，由于解空间被表示为二进制串，因而解空间可以作为一个希尔伯特空间，从而允许量子算法的运行。而解的好坏，则将其划分为两个子空间——称为好空间与坏空间。于是解空间的任意纯态$| \psi \rangle$都可以被分解表示为：

$$| \psi \rangle=| \psi_0 \rangle+| \psi_1 \rangle$$

其中$| \psi_0 \rangle$表示落入坏空间的部分，相应地$| \psi_1 \rangle$表示落入好空间的部分。于是$b_\psi=\langle \psi_0 | \psi_0 \rangle$表示了对这个纯态测量后得到坏结果的概率，$a_\psi=\langle \psi_1 | \psi_1 \rangle$则是得到好结果的概率，以后简记为$a$。显然$a_\psi+b_\psi=1$。

到这一步，我们的目标就已经清晰明朗了：只要让好空间部分的$| \psi_1 \rangle$振幅变大，就提高了测到好结果的概率。之后只需要代入$\mathcal{X}$判定其是否确实是好结果即可。

---

## 二、振幅放大的构建

### 1.

假定$n$是解空间的二进制串的长度。假设无测量量子算法$\mathcal{A}$是作用到解空间上的酉矩阵，并假设纯态$| \Psi \rangle=\mathcal{A}| 0^n \rangle$是由其作用到初始零态的结果。那么如下构建的算符即可实现振幅放大：

$$\mathbf{Q}=\mathbf{Q}(\mathcal{A},\mathcal{X})=-\mathcal{A}\mathbf{S}_0\mathcal{A}^{-1}\mathbf{S}_\mathcal{X}$$

其中，$\mathbf{S}$代表它会改变振幅的符号，而下标表示改变的条件：

$$\mathbf{S}_0| x \rangle=\begin{cases}
    -| x \rangle & ,\quad if\ x=0^n\\
    | x \rangle & ,\quad if\ x\neq0^n\\
\end{cases}$$

$$\mathbf{S}_\mathcal{X}| x \rangle=\begin{cases}
    -| x \rangle & ,\quad if\ \mathcal{X}(x)=1\\
    | x \rangle & ,\quad if\ \mathcal{X}(x)=0\\
\end{cases}$$

>显然可以将$\mathbf{S}_0$写为$I-2| 0^n \rangle\langle 0^n |$，于是：
>$$\begin{aligned}
    \mathcal{A}\mathbf{S}_0\mathcal{A}^{-1}&=\mathcal{A}(I-2| 0^n \rangle\langle 0^n |)\mathcal{A}^{-1}\\
    &=I-2\mathcal{A}| 0^n \rangle\langle 0^n |\mathcal{A}^{-1}\\
    &=I-2| \Psi \rangle\langle \Psi |
\end{aligned}$$

现在我们来研究算符$\mathbf{Q}$作用到任意态上会发生什么。由于在这个问题中纯态被分解为好纯态和坏纯态，因此研究此算符分别作用到好坏纯态上的结果。首先是坏纯态$| \Psi_0 \rangle$：

$$\begin{aligned}
    \mathbf{Q}| \Psi_0 \rangle&=-\mathcal{A}\mathbf{S}_0\mathcal{A}^{-1}\mathbf{S}_\mathcal{X}| \Psi_0 \rangle\\
    &=-\mathcal{A}\mathbf{S}_0\mathcal{A}^{-1}| \Psi_0 \rangle\\
    &=-(I-2| \Psi \rangle\langle \Psi |)| \Psi_0 \rangle\\
    &=-| \Psi_0 \rangle+2(1-a)| \Psi \rangle\\
    &=(1-2a)| \Psi_0 \rangle+2(1-a)| \Psi_1 \rangle\\
\end{aligned}$$

同理对于好纯态$| \Psi_1 \rangle$：

$$\begin{aligned}
    \mathbf{Q}| \Psi_1 \rangle&=-\mathcal{A}\mathbf{S}_0\mathcal{A}^{-1}\mathbf{S}_\mathcal{X}| \Psi_1 \rangle\\
    &=(I-2| \Psi \rangle\langle \Psi |)| \Psi_1 \rangle\\
    &=| \Psi_1 \rangle-2a| \Psi \rangle\\
    &=-2a| \Psi_0 \rangle+(1-2a)| \Psi_1 \rangle\\
\end{aligned}$$
