# 离散数学(二)——一阶逻辑

离散数学的前半部分，大抵都是对“命题”的数学结构化描述。一阶逻辑在命题逻辑公式的基础上，通过引入一些其他的符号，完善了对具体-抽象类型命题的描述与判断。

## 一、基本概念

### 1.个体与谓词

首先，我们要细分**原子命题**的结构。原子命题本身是对一个事物性质的直接描述、或是对几个事物间关系的判断，这里的“事物”就被称为**个体**。个体通常可以替换为其他的实例，这种不确定性使之具有“变量”的意味，我们以小写字母$x,y,z...$来表示个体，称为**个体变量**。

对个体进行性质或关系的判断，称为**谓词**。谓词，即对个体变量的判断，是从个体变量到真值的映射，使之具有“函数”的意味，我们通常用大写字母$P,Q,R...$表示一个谓词，并在其后的括号中填入个体变量表示对其判断。例如$P(x)$，表示“$x$具有性质$P$”。

谓词必须作用于个体变量上，但个体变量的数量不限。这样，如果要表示“$x,y$具有关系$Q$”，就可以形式化地表示为$Q(x,y)$。一个谓词能作用的个体数目称为**元数**，元数为$n$的谓词称为$n$**元谓词**。

>谓词也可以作用在谓词、函数、公式之类之上，但是这不属于**一阶逻辑**的范畴。一阶逻辑指的是**一阶谓词逻辑**，所谓一阶谓词就是指只作用在个体上的谓词。上述可作用在谓词等之上的谓词称为高阶谓词。

个体变量自然可以拥有具体的赋值，称为**个体常量**，常以$a,b,c...$表示。比如$P(x)$可以具体例化为$P(a)$。

### 2.量词

具体应用时，常常要说明是否是全体个体都符合谓词，这就引入了**量词**。其一是**全称量词**，以$\forall$表示。例如，要表示“全体的$x$都有性质$P$”，就符号化为$\forall xP(x)$。这种命题称为**全称命题**。

其二是**存在量词**，以$\exists$表示。例如，要表示“部分的$x$都有性质$P$”，就符号化为$\exists xP(x)$。这种命题称为**存在命题**。全称命题和存在命题统称为**量化命题**。

>一阶逻辑中，量词也只允许作用于个体变量上，不允许作用于谓词上。

### 3.论域与特征谓词

就像上述所说，个体变量的“变量”意味、谓词的“函数”意味，是我们必须限定个体变量的“范围”，这类似于限定函数的定义域。对个体变量所限定的范围，就称为这个个体变量的**论域**。

>例如，命题“所有自然数都大于等于$0$”，可以符号化为$\forall xP(x)$。其中$x$表示自然数，$P(x)$表示“$x$大于等于$0$”，那么$x$的论域就是自然数集。

就像是函数的定义域，论域自然可以是其他论域的子集，但扩大论域显然极有可能使原来的命题失效。为此，必须要多引入一个谓词，以限定论域的范围，这个谓词称为**特征谓词**。

>还是以上面为例，命题“所有自然数都大于等于$0$”，如果$x$的论域是实数集，$P(x)$表示“$x$大于等于$0$”，那么必须引入额外的谓词$Q(x)$表示“$x$是自然数$0$”以限定$x$的范围，这个谓词就是特征谓词。此时公式符号化为$\forall x(Q(x)\rightarrow P(x))$。

---

## 二、一阶逻辑公式的基本概念

### 1.逻辑符号与非逻辑符号

与命题逻辑公式类似，为了定义**一阶逻辑公式**——通常简称为**一阶公式**或**公式**——首先必须要区分公式中的所有符号。在公式中，符号分为**逻辑符号**与**非逻辑符号**。

**逻辑符号集**中包括：

(1)逻辑运算符$\lnot,\land,\lor,\rightarrow,\leftrightarrow$，量词符号$\forall,\exist$，和辅助表明运算顺序的左右圆括号$(,)$，以及多元谓词中分隔各变量的逗号$,$；

(2)个体变量集，例如$x,y,z...$，这个集合单独记为$V$。

**非逻辑符号集**，记为$\mathcal{L}$，包括：

(1)个体常量集，例如$a,b,c...$；

(2)谓词符号，例如$P,Q,R...$；

(3)函数符号，例如$f,g,h...$，出现时常以算术运算符$+,-,\times,\div...$出现。

### 2.项与公式

与多项式中的项相似，公式中的**项**是变量与常量通过函数耦合构造的较复杂的个体。

>归纳定义如下：在给定非逻辑符号集$\mathcal{L}$和个体变量集$V$的情况下，公式的项是：
(1)归纳基：$\mathcal{L}$中的个体常量和$V$中的个体变量都是项；
(2)归纳步：对$\mathcal{L}$中的任意$n$元函数$f$，若$t_1,t_2,...,t_n$是项，那么$f(t_1,t_2,...,t_n)$也是项。

公式则是子公式通过逻辑运算符号和量词符号耦合构造的较复杂公式，而原子公式是仅由谓词生成的不可再分的简单公式。

>归纳定义如下：在给定非逻辑符号集$\mathcal{L}$和个体变量集$V$的情况下，公式是：
(1)归纳基：对$\mathcal{L}$中的任意$n$元谓词$F$，若$t_1,t_2,...,t_n$是项，那么$F(t_1,t_2,...,t_n)$是公式，并且是原子公式；
(2)归纳步：若$x$是个体变量，$A,B$是公式，那么：$(\lnot A),(A\land B),(A\lor B),(A\rightarrow B),(A\leftrightarrow B),\forall xA,\exist xA$都是公式。

上述归纳步中的七个公式形式，分别称为否定式、合取式、析取式、蕴涵式、双蕴含式、全称量词公式、存在量词公式，其中后二者合称为量词公式。

### 3.辖域，自由变量和约束变量

假设有公式$A=\forall xB$，那么个体变量$x$称为量词$\forall x$的**指示变量**，称子公式$B$为这个量词的**辖域**或**作用域**。

如果个体变量$x$在$A$中的一处**出现**，是在以自己为指示变量的量词公式的辖域(即$B$)中，那么称之为**约束出现**。否则称为**自由出现**。

如果个体变量$x$在$A$中的所有出现都是约束出现，那么称$x$是$A$的**约束变量**。否则称为**自由变量**。即$x$只要有一个或以上自由出现，就是自由变量。

如果一个公式没有自由变量，那么将公式称为**闭公式**或**句子**。

在上述的例子中，将全称量词$\forall$替换为存在量词$\exist$，也是一样的。

有时为了避免一个变量既约束出现又自由出现，我们会对公式做**约束变量改名**，或者**自由变量替换**，这两种方法的结果殊途同归，但约束变量改名更加保险。依然以$A=\forall xB$为例，约束变量改名是指：将指示变量$x$、与$B$中自由出现的$x$，都替换为一个不在$A$中自由出现的个体变量$y$。

>需要注意的是，对于同一个位置的$x$，在$A$中约束出现的$x$在$B$中不一定是约束出现！例如，$A=\forall xB=\forall x(F(x)\rightarrow \forall zG(z))$，其中$B=F(x)\rightarrow \forall zG(z)$，$x$在$A$中约束出现，在$B$中却是自由出现。

在上述的例子中，将$\forall$替换为$\exist$，也是一样的。

---

## 三、一阶逻辑公式的等值式

### 1.基本等值式

与命题逻辑公式相同，**基本逻辑等值式**也能完全用在一阶公式上。在这里复习一下基本逻辑等值式：

(1)**同一律**：$A\land 1\equiv A\qquad A\lor 0\equiv A$

(2)**零律**：$A\land 0\equiv 0\qquad A\lor 1\equiv 1$

(3)**矛盾律**：$A\land (\lnot A)\equiv 0$

(4)**排中律**：$A\lor (\lnot A)\equiv 1$

(5)**双重否定律**：$\lnot(\lnot A)\equiv A$

(6)**幂等律**：$A\land A\equiv A\qquad\ A\lor A\equiv A$

(7)**交换律**：$A\land B\equiv B\land A\qquad A\lor B\equiv B\lor A$

(8)**结合律**：$A\land (B\land C)\equiv (A\land B)\land C\qquad A\lor (B\lor C)\equiv (A\lor B)\lor C$

(9)**分配律**：$A\land (B\lor C)\equiv (A\land B)\lor (A\land C)\qquad A\lor (B\land C)\equiv (A\lor B)\land (A\lor C)$

(10)**吸收律**：$A\land (A\lor B)\equiv A\qquad A\lor (A\land B)\equiv A$

(11)**德摩根律**：$\lnot (A\land B)\equiv (\lnot A)\lor(\lnot B)\qquad \lnot (A\lor B)\equiv (\lnot A)\land(\lnot B)$

(12)**蕴涵等值式**：$A\rightarrow B\equiv\lnot A\lor B$

(13)**蕴涵等值式**：$A\leftrightarrow B\equiv (A\rightarrow B)\land (B\rightarrow A)$

除此之外，量词的引入使得**一阶公式**还有其他的逻辑等值式。如下列：

(14)**量词交换等值式**：

$$\forall x\forall yF(x,y)\equiv\forall y\forall xF(x,y)\\ \exist x\exist yF(x,y)\equiv\exist y\exist xF(x,y)$$

(15)**量词分配等值式**：

$$\forall x(A(x)\land B(x))\equiv\forall xA(x)\land \forall xB(x)\\ \exist x(A(x)\lor B(x))\equiv\exist xA(x)\lor \exist xB(x)$$

(16)**消除量词等值式**：

$$\forall xA(x)\equiv A(a_1)\land A(a_2)\land ...\land A(a_n)\\ \exist xA(x)\equiv A(a_1)\lor A(a_2)\lor ...\lor A(a_n)$$

(17)**量词否定等值式**：

$$\lnot \forall xA(x)\equiv\exist x\lnot A(x)\\ \lnot \exist xA(x)\equiv\forall x\lnot A(x)$$

(18)**量词辖域扩张收缩**，这部分等值式非常重要，并且使用时要求符合成立条件，即“$A(x)$是含自由变量$x$的公式、并且$x$不在$B$中出现”：

$$\begin{aligned}
    \forall x(A(x)\land B)&\equiv\forall xA(x)\land B\\
    \forall x(A(x)\lor B)&\equiv\forall xA(x)\lor B\\
    \forall x(A(x)\rightarrow B)&\equiv\exists xA(x)\rightarrow B\\
    \forall x(B\rightarrow A(x))&\equiv B\rightarrow \forall xA(x)\\
    \exists x(A(x)\land B)&\equiv\exists xA(x)\land B\\
    \exists x(A(x)\lor B)&\equiv\exists xA(x)\lor B\\
    \exists x(A(x)\rightarrow B)&\equiv\forall xA(x)\rightarrow B\\
    \exists x(B\rightarrow A(x))&\equiv B\rightarrow \exists xA(x)\\
\end{aligned}$$

### 2.前束范式

**前束范式**是一种结构规整的公式。假设以$Q$表示量词符号即$\forall$或$\exist$，$A$表示一个不含**量词**的公式，那么前束范式的形式为：

$$Q_1x_1Q_2x_2...Q_kx_k\ A$$

也就是，所有的量词都被束缚在公式的前面。前束范式对于之后的推理中的例化泛化非常重要。为了从任意公式化为前束范式的形式，可以遵从以下步骤：

(1)使用*约束变量改名*，使所有个体变量要么*约束出现*、要么*自由出现*。并且，应使每个量词的指示变量均不相同；

(2)使用*量词否定等值式*，将否定逻辑符放到量词之后；

(3)使用*量词辖域扩张等值式*，将量词放到所有逻辑运算符之前。

可以对变换之后的公式做检查。一种简单的检查方式是，除指示变量外，对于相同位置的个体变量，原先是约束出现的变换后还是约束出现，原先是自由出现的变换后还是自由出现。如非如此，必有错误。

---

## 四、一阶逻辑公式的真值

这一部分的理论内容是较为晦涩的，这里尽量以通俗的语言来描述，避免书本上的公理化描述。

### 1.个体变量指派函数

公式本身是一种**抽象语言**，在只给定“公式”这一字符串的时候，它只有数学上的意义。但是，我们显然可以将一些具体情况应用在给定的公式上，而且可以有多种不同的具体情况，这就是通俗意义上的公式的**解释**，并以$\mathcal{M}$表示。也就是说，一个*抽象*的公式可以有多个*具体*的解释。

>正确的说法是，解释是对一阶公式的**非逻辑符号集**的解释，而不是对公式的解释。
>解释亦称为**模型**。非逻辑符号集的解释首先需要包含一个非空的*论域*，以及至少一个*谓词*。其次还可以包含*个体常量*和*函数*，但并非必须。
>上述的四个非逻辑符号也都有自己的解释，用$\llbracket...\rrbracket$表示。比如，如果非逻辑符号集中有谓词$F$，那么此谓词在这个论域上的解释就记为$\llbracket F\rrbracket$。

正如之前所说，*论域*可以简单类比理解为公式的定义域。那么，解释中的个体常量，就相当于选取论域(定义域)中的一个具体的对象，将其赋值到公式中的某个个体变量中。这称为**个体变量指派函数**，记为$\sigma$。例如，如果将公式中的$x$指派为解释的论域中的一个元素$a$，就记为$\sigma(x)=a$。

指派函数的**变换**的定义略显奇怪：设$x$是个体变量集中的一个变量，$d$是解释的论域中的一个元素，那么对任意个体变量集中的一个变量$y$，其指派函数记为$\sigma[x\mapsto d]$，定义为：

$$\sigma[x\mapsto d](y)=\begin{cases}
    d\qquad &y=x\\
    \sigma(y)&y\neq x
\end{cases}$$

乍一看不知所云，但笔者的通俗理解是：这个变换函数是在将$x$指派为$d$的情况下(即中括号中的内容)，对$y$的指派。

>例如，假设$\sigma(x)=a,\sigma(y)=b$，那么$\sigma[x\mapsto d](y)=\sigma(y)=b$。这个函数似乎有些啰嗦！目前还不太清楚这个函数的意义，但请看之后的内容。

### 2.公式的真值

在上述定义中，个体变量指派函数是将一个个体变量指派为论域中的一个个体常量。$\sigma$函数中也可以对一个公式起作用，此时它就类似于命题逻辑中的真值赋值函数。即，$\sigma(A)$只能等于$\bm0$或$\bm1$。

要判断公式的真值，就应当从其原子公式下手。一个原子公式的真值，取决于谓词的解释中是否含有被指派的变量(仅是一种浅显的说法！不一定完全正确！)。

>比如，假设$\mathcal{M}$的论域$D=\{ a,b,c \}$，而一个一元谓词的解释$\llbracket F\rrbracket=\{ a,b \}$，一个二元谓词的解释$\llbracket G\rrbracket=\{ \langle a,b\rangle,\langle a,c\rangle \}$。那么：
>$\sigma[x\mapsto a](F(x))=\bm1,\quad\sigma[x\mapsto b](F(x))=\bm1,\quad\sigma[x\mapsto c](F(x))=\bm0$
>$\sigma[x\mapsto a][y\mapsto a](G(x,y))=\bm0,\quad\sigma[x\mapsto a][y\mapsto b](G(x,y))=\bm1,\quad\sigma[x\mapsto a][y\mapsto c](G(x,y))=\bm1$
>这里可以结合上面“指派函数的变换”理解。

当与量词结合后，就应当应用*消除量词等值式*进行展开。

>还是以上例为例。$\sigma[x\mapsto a](F(x))=\bm1$这个形式略显麻烦，不妨记为$F(a)\equiv\bm1$(严格来说这样写是不符合等值式的形式的，但是不至于混淆的情况下如此简写也是可以的)。那么，假设公式$A=\forall xF(x)$，那么$A$就应当展开为：
>$$F(a)\land F(b)\land F(c)\equiv\bm1\land \bm1\land \bm0\equiv\bm0$$
>即$\sigma(A)=\bm0$。

### 3.公式的分类

假设有一个公式$A$，其非逻辑符号集为$\mathcal{L}$，那么：

(1)如果$A$在$\mathcal{L}$中的任意解释、在任意个体变量指派函数下，其真值都为真，那么称为**永真式**，也称为**普遍有效式**；

(2)如果$A$在$\mathcal{L}$中的任意解释、在任意个体变量指派函数下，其真值都为假，那么称为**矛盾式**；

(3)如果$A$不是矛盾式，那么称$A$是**可满足的**。

有时候利用命题逻辑中的永真式或矛盾式可以快速判断公式是一个永真式或矛盾式。比如，$p\rightarrow(q\rightarrow p)$是一个命题逻辑永真式，那么$\forall xF(x)\rightarrow(\exist xG(x)\rightarrow \forall xF(x))$也必是永真式。但这不是充分必要的，命题逻辑形式不是永真式的，一阶逻辑形式的也可能是永真的。

---

## 五、一阶逻辑的推理论证

一阶逻辑的推理、论证的定义与命题逻辑是相似的，不再赘述。命题逻辑的推理规则也完全适用于一阶逻辑。我们复习一下九个基本推理规则：

(1)**假言推理**：$A\rightarrow B,A\Longrightarrow B$

(2)**假言易位**：$A\rightarrow B,\lnot B\Longrightarrow \lnot A$

(3)**合取**规则：$A,B\Longrightarrow A\land B$

(4)**化简**规则：$A\land B\Longrightarrow A$

(5)**附加**规则：$A\Longrightarrow A\lor B$

(6)**析取三段论**规则：$\lnot A,A\lor B\Longrightarrow B$

(7)**假言三段论**规则：$A\rightarrow B，B\rightarrow C\Longrightarrow A\rightarrow C$

(8)**双蕴涵推理**规则：$A\leftrightarrow B\Longrightarrow A\rightarrow B \quad,\quad A\leftrightarrow B\Longrightarrow B\rightarrow A$

(9)**等值置换**规则：对所有一阶逻辑等值式模式$A\equiv B$，都存在$A\Longrightarrow B$和$B\Longrightarrow A$。

由于量词的引入，一阶逻辑的推理还有四个额外的推理规则：

(10)**全称例化**规则，又称为**全称量词消除**规则。这条规则包含两种形式。其一，若$x$不在$A(x)$中的任意量词$\forall y$或$\exist y$的辖域中自由出现，那么：

$$\forall xA(x)\Longrightarrow A(y)$$

其二，这个形式没有特殊的要求，$c$可以是任意个体常量：

$$\forall xA(x)\Longrightarrow A(c)$$

(11)**全称泛化**规则，又称为**全称量词引入**规则。若$x$不在$A(y)$中约束出现、并且不是$A(y)$中除$y$之外的其他自由变量，以及$y$不是前提公式、或消除附加前提前的附加前提公式中的自由变量，那么：

$$A(y)\Longrightarrow \forall xA(x)$$

(12)**存在例化**规则，又称为**存在量词消除**规则。若$A(x)$只含有自由变量$x$、没有其他自由变量，并且将要替换$x$的个体常量$c$在前提、$A(x)$以及所有之前的论证公式序列中**都不出现**，那么：

$$\exist xA(x)\Longrightarrow A(c)$$

(13)**存在泛化**规则，又称为**存在量词引入**规则。这个规则的要求不高，只要将要替换$c$的$x$不在$A(c)$中出现即可：

$$A(c)\Longrightarrow \exist xA(x)$$

应当注意**全称、存在例化**中前提公式的形式。$\forall xA(x)$，$\exist xA(x)$都是**前束范式**，在使用这两个规则之前必须首先将公式化为前束范式。

与命题逻辑相似，当推理的结论是**蕴涵式**时，应当使用**附加前提法**；当推理的结论是**否定式**时，应当使用**反证法**。在使用附加前提法时，务必注意**全称泛化**的使用条件。
