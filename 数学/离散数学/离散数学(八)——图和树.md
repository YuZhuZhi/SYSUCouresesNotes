# 离散数学(八)——图和树

## 一、图基础

### 1.基础概念

这里我们直接略去无向图、有向图、顶点集、边集、关联、端点、混合图、(非)标定图、关联、邻接等的概念。但需要知道，通常将一幅**图**记为$G$，以$V(G),E(G)$表示它的**顶点集**和**边集**，$|V(G)|,|E(G)|$表示它的**顶点数**和**边数**。

假如$|V(G)|=n$，也就是图有$n$个顶点，那么称之为$n$**阶图**。如果$|E(G)|=0$，也就是图中没有边，那么称之为**零图**。同样地，记$n$**阶零图**为$N_n$，它是有$n$个顶点的零图，这其中$N_1$称为**平凡图**。

虽然图的定义要求顶点数不为$0$，但是我们依然约定当顶点集为空集时，称图为**空图**。

对于一条边，它有两种特殊状态。一种是，$e=(v,v)$，这是在说这条边关联同一个顶点，那么称之为**环**；另一种是，$e=(u,v)$存在的同时，还有另一条边$e'=(u,v)$，也就是这两条边都关联同样的顶点，那么称它们为**重边**。

而对于不存在环和重边的图，称为**简单图**。

对于有向图中的一个顶点$v\in V$，它的**入度**是指以$v$为**终点**的有向边的条数，记为$d^-(v)$；同样地，也有**出度**，是指以$v$为**起点**的有向边的条数，记为$d^+(v)$。入度和出度之和，称为顶点的**度数**，也就是$d(v)=d^-(v)+d^+(v)$。

在无向图中，如果一个顶点的度数为$1$，那么称它为**悬挂顶点**，其关联的边称为**悬挂边**。而度数为$0$的点称为**孤立顶点**。

### 2.握手定理

**握手定理**的本质就是：对于一条有向边，有始必有终，因此在统计入度和出度的时候最终两者必定相等；而一条边必然关联两个顶点，因此入度和出度之和，或者说所有顶点的度数之和，必定是顶点数的两倍。也就是：

(1)对无向图：$\displaystyle\sum d(v)=2|E|$；

(2)对有向图：$\displaystyle\sum d^-(v)=\sum d^+(v)=|E|$。

我们称度数为奇数的顶点为**奇度顶点**，度数为奇数为**偶度顶点**。这样，由于总度数之和必为偶数，因此**奇度顶点的个数必然是偶数**。

遍历所有顶点的度数。我们将图$G$的**最小度**记为$\delta(G)=min\{d(v)\}$，它是所有顶点度数中的最小值；将**最大度**记为$\Delta(G)=max\{d(v)\}$，它是所有顶点度数中的最大值。

那么，若$G$是**简单图**，那就必有$\Delta(G)\leq n-1$。

### 3.正则图，完全图和二部图

假如一个图$G$的所有顶点的度数**都等于**$k$，那么称$G$为$k$**正则图**。注意这并不要求图$G$是简单图。

当$G$是**简单图**时，如果任意两个顶点之间都有边，那么称之为**完全图**。当图中具有$n$个顶点，称为$n$**阶完全图**，记为$K_n$。

对于一个图$G$，现在我们将它的顶点集$V$**划分**为两部分$V_1,V_2$。如果存在一种划分，使得原本图中所有存在的边所关联的两个顶点，一个在$V_1$中而另一个在$V_2$中，或者说不存在原有的边连接了$V_1$中的两个顶点或$V_2$中的两个顶点，那么称$V_1,V_2$是$V$的一个**二部划分**，图$G$称为**二部图**。

假如二部图$G=(V,E)$的顶点集具有一个二部划分$V_1,V_2$。若$V_1$中的任一顶点，与$V_2$中的所有顶点都恰好有一条边关联，那么称$G$为**完全二部图**。

### 4.子图

给定图$G=(V,E),G'=(V',E')$。假如$V'\subseteq V,E'\subseteq E$，那么称$G'$是$G$的**子图**。其中，假如$V=V'$，那么就称$G'$是$G$的**生成子图**。

---

## 二、图的连通

### 1.通路与回路

首先假设图$G=(V,E)$，那么它的一条**通路**$\varGamma=v_0e_1v_1e_2...e_nv_n$，是从通路**端点**$v_0$到$v_n$的经过边$e_0e_1...e_n$的一条路，其**长度**为$n$。假如$v_0=v_n$，那么称此通路为**回路**。

若一条通路或回路不含有重复的边，则称为**简单通路**或**简单回路**。若一条通路中不含有重复的顶点，则称为**初级通路**，或称为**路径**。若一条回路中除端点外不含重复的顶点，则称为**初级回路**，或称为**圈**。

在有向图中，上述概念只需添加“有向”二字即可。

假设图$G=(V,E)$有$n$个顶点，那么给出以下定理：

(1)若存在从$u$到$v$的通路，那么必然存在从$u$到$v$的长度小于等于$n-1$的初级通路；

(2)若存在从$u$到自身的回路，那么必然存在从$u$到自身的长度小于等于$n$的初级回路。

### 2.无向图的连通

假设图$G=(V,E)$是无向图。如果顶点$u,v$间存在通路，就称$u$和$v$是**可达的**，并记为$u\leftrightarrow v$。约定顶点与顶点本身总是可达的。

若在图中任意两个顶点都是可达的，那么称$G$是**连通无向图**。当图$G$是**简单图**、并且是**连通图**时总存在$|E|\geq|V|-1$。

如果无向图中存在“独立”的几部分，也就是这几部分之间不存在边将其连通，则称这几个部分(是$G$的子图)为$G$的**连通分支**。我们将$G$的**连通分支数**记为$p(G)$。

如果在图$G$中存在某条边$e$，将其删去之后$p(G)$发生变化(应该说，必然是增大)，也就是产生了将原来的连通分支分为两个连通分支，则称这条边$e$为$G$的**割边**，或称为**桥**。

### 3.有向图的连通

假设图$G=(V,E)$是**有向图**。如果从顶点$u$到$v$间存在通路，就称$u$可达$v$，并记为$u\rightarrow v$。若在$u\rightarrow v$的同时有$v\rightarrow u$，那么就记$u\leftrightarrow v$。也同样约定总有$u\leftrightarrow u$。

如果$G$中任意两个顶点$u,v$中都存在$u\leftrightarrow v$，那么称$G$为**强连通有向图**；而如果$u\rightarrow v$和$v\rightarrow u$中必有其一成立，那么称$G$为**单向连通有向图**；如果$G$的基图是**无向连通图**，那么称$G$为**弱连通有向图**。

>有向图的**基图**，是指将所有有向边都视作无向边之后生成的无向图。

为了判定有向图$G$是强连通的，只需要在图中寻找一条经过每个顶点至少一次的有向回路。因此，强连通有向图是单向连通有向图；而单向连通有向图也是弱连通有向图。

### 4.领接矩阵

**邻接矩阵**在《关系》中已经介绍过，不再赘述。显然无向图的邻接矩阵必是**对称矩阵**，而有向图则不一定。有向图的领接矩阵中，**行**中元素的和是此行对应顶点的**出度**，而**列**中元素的和是此列对应顶点的**入度**。简单图的邻接矩阵中元素只有$0,1$两种。

对于图的邻接矩阵$A$，以普通的乘法来计算它的幂，那么$A^k$就是表明两个顶点间长度为$k$的通路的条数；因此以《关系》中的特殊乘法来说，就只是判断是否存在长度为$k$的通路。

而记$B=A+A^2+...+A^{n-1}$，这个矩阵表明两个顶点间长度小于等于$n-1$的通路的条数。这样，将这个矩阵中的元素单位化，形成一个只有$0,1$的矩阵$P$，这就是图$G$的**可达矩阵**，相当于《关系》中的传递闭包。因此可达矩阵同样可以使用$Warshall$算法求出。

---

## 三、树基础

**树**是一种特殊的图。

### 1.无向树

设图$G=(V,E)$是**简单无向图**。若$G$是**连通图**，并且**没有回路**，那么称$G$是**无向树**，可以记为$T=(V,E)$。将无向树中度数为$1$的顶点称为**树叶**，度数大于等于$2$的称为**分支点**。如果图中存在多个无回路的连通分支，那么称$G$是**森林**。

说一个图是树时，默认此树为无向树。

设图$G=(V,E)$是简单无向图。那么以下四个命题**互相等价**：

(1)$G$是树，也即$G$是连通图且没有回路；

(2)$G$的任意两个顶点之间存在唯一的通路；

(3)$G$是连通的，并且任意一条边都是**桥**；

(4)$G$虽然没有回路，但在任意两个不相邻的顶点间加一条边，会得到唯一一个、并且含有此新边的回路。

以下四个命题也**互相等价**：

(1)$G$是树，也即$G$是连通图且没有回路；

(2)$G$是连通的，并且任意一条边都是**桥**；

(3)$G$中没有回路，并且$|E|=|V|-1$；

(4)$G$是连通的，并且$|E|=|V|-1$。

树中的等式$|E|=|V|-1$与握手定理结合，常常是证明的要点。

### 2.根树

如果一个**有向图**的基图是树，那么称这个图为**有向树**。而如果一个有向树$T$有且仅有一个顶点$r$的入度为$0$，那么称$T$是以$r$为根的**根树**。根树中的顶点也称为**节点**。出度为$0$的节点称为**叶子**，出度不为$0$的称为**内部顶点**。

我们再次略去父亲。儿子、祖先、后代、子树的定义。而所谓的节点$u$的**层数**，是指从$r$到$u$的**唯一通路**的长度。因此，根的层数是$0$。而树$T$的**高度**，是指从$r$到$T$的叶子的**最长通路**的长度。

如果根树的每个节点的出度都小于等于$m$，那么称此树为$m$**元树**。当每个节点的出度不是$m$就是$0$时，则称此树为**满$m$元树**，或称**正则$m$元树**。而对于满$m$元树来说，如果每个叶子的层数都等于树高，则称之为**完全$m$元树**。若高度为$h$的$m$元树的叶子的层数要么是$h$要么是$h-1$，则称之为**平衡$m$元树**。

---

## 四、平面图

一个**平面图**，是指一个能画在平面上、而任两条边之间不存在除顶点外的其他交点的图。现在假设图$G$是平面图。

平面图中的一个**面**$R=(V,E)$，是由它的若干条边包围而成、且不含图的顶点和边的区域。而包围面$R$的若干条边构成的**回路**，称为此面的**边界**，这条回路的长度称为此面的**度**，并记为$deg(R)$。由平面图的“外部”的边包围的无穷大的面称为平面图的**外部面**，而其他的面都称为**内部面**。

### 1.几个定理

与握手定理同样的原理，一条边必是两个面的边界，因此**平面图的所有面的度数之和等于边数的两倍**：$\displaystyle\sum deg(R)=2|E|$

第二个重要的公式是**欧拉公式**。记连通平面图有$n$个顶点、$m$条边、$d$个面，那么恒有$n-m+d=2$。

记$g(G)$是图$G$中**长度最小的回路**的长度，称为$G$的**围长**。在平面图中，围长显然就是所有面中最小的度数。记$l=g(G)$，那么由第一条定理，应有$l\times d\leq 2m$；而由欧拉公式，应有$d=2+m-n$。联合两式，得到：

$$m\leq\dfrac{l}{l-2}(n-2)$$

### 2.极大平面图

设简单平面图$G=(V,E)$有**至少四个顶点**。若在$G$中任意两个**不相邻**顶点间添加一条新边、都将使平面图变成非平面图，那么称$G$为**极大平面图**。

极大平面图具有以下性质：

(1)极大平面图是**连通图**；

(2)极大平面图中**没有桥**；

(3)极大平面图的每个面的度数都为$3$；

(4)记$d$为面数、$m$为边数，那么极大平面图中$3d=2m$；

(5)极大平面图中$\delta(G)\geq 3$；

(6)设$v$是极大平面图中的任一顶点。那么$v$必与其相邻顶点构成回路。

利用$3d=2m$与欧拉定理，可以得到另外两条等式：

$$m=3n-6\quad,\quad d=2n-4$$

既然对于极大平面图来说上面两条等式成立，那么更具有一般意义的**简单平面图**必有下列两条不等式：

$$m\leq3n-6\quad,\quad d\leq2n-4$$

---

## 五、欧拉图

设**无向连通图**$G=(V,E)$。$G$中的一条能够经过所有边的简单通路或简单回路称为$G$的**欧拉通路**或**欧拉回路**。而含有欧拉通路的图称为**半欧拉图**，含有欧拉回路的图称为**欧拉图**。

一个无向连通图$G=(V,E)$中存在**欧拉回路**的充要条件是：$G$中所有顶点的度数都为**偶数**。

而若$G$中只有两个度数为奇数的顶点，那么图中存在**欧拉通路**。

---

## 六、哈密顿图

类似于欧拉图中的定义。但它是以**初级通路**为基础。

设无向图$G$。$G$中的一条能够经过所有边的初级通路或初级回路称为$G$的**哈密顿通路**或**哈密顿回路**。而含有哈密顿通路的图称为**半哈密顿图**，含有哈密顿回路的图称为**哈密顿图**。

对于无向图中的一条通路$\varGamma=v_0e_1v_1e_2...e_nv_n$，如果不存在其他顶点$v\in V,v\neq v_i$使$v$与$v_0$或$v_n$相邻，那么称此通路为**极长通路**。如果此极长通路又是**初级通路**，那么称之为**极长初级通路**。

一个简单图存在**哈密顿通路**的充分条件是：如果$n$阶简单图$G$中的任意两个顶点的度数之和都大于等于$n-1$，那么$G$存在**哈密顿通路**。这里要求$n\geq2$。

因此，若$n(n\geq3)$阶的简单图$G$中的任意两个顶点的度数之和都大于等于$n$，那么$G$存在**哈密顿回路**；或者，任意顶点的度数都大于等于$\dfrac{n}{2}$，那么$G$存在**哈密顿回路**。
